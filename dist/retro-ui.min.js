(function(window,document){'use strict';const RetroUI={version: '1.0.0',config:{closeOnOutsideClick: true,closeOnEscape: true,animationDuration: 300,debug: false},utils:{log: function(message){if(RetroUI.config.debug){console.log('[RetroUI]',message);}},isVisible: function(element){return element && element.offsetParent !==null;},getFocusableElements: function(element){return element.querySelectorAll('a[href],button,input,textarea,select,details,[tabindex]:not([tabindex="-1"])');},trapFocus: function(element){const focusableElements=this.getFocusableElements(element);const firstFocusable=focusableElements[0];const lastFocusable=focusableElements[focusableElements.length-1];element.addEventListener('keydown',function(e){if(e.key==='Tab'){if(e.shiftKey){if(document.activeElement===firstFocusable){lastFocusable.focus();e.preventDefault();}}else{if(document.activeElement===lastFocusable){firstFocusable.focus();e.preventDefault();}}}});if(firstFocusable){firstFocusable.focus();}}},ProgressBar:{update: function(element,value){if(typeof element==='string'){element=document.querySelector(element);}if(element && element.classList.contains('retro-progress')){const clampedValue=Math.max(0,Math.min(100,value));element.style.setProperty('--progress',clampedValue);element.setAttribute('data-progress',clampedValue);element.setAttribute('aria-valuenow',clampedValue);RetroUI.utils.log(`Progress updated to ${clampedValue}%`);}},animate: function(element,targetValue,duration=1000){if(typeof element==='string'){element=document.querySelector(element);}if(!element || !element.classList.contains('retro-progress')){return;}const startValue=parseInt(element.style.getPropertyValue('--progress')|| '0');const endValue=Math.max(0,Math.min(100,targetValue));const startTime=Date.now();function updateProgress(){const elapsed=Date.now()-startTime;const progress=Math.min(elapsed/duration,1);const easeProgress=1-Math.pow(1-progress,3);const currentValue=startValue+(endValue-startValue)*easeProgress;RetroUI.ProgressBar.update(element,currentValue);if(progress < 1){requestAnimationFrame(updateProgress);}}requestAnimationFrame(updateProgress);}},Dropdown:{init: function(){const dropdowns=document.querySelectorAll('.retro-dropdown,details[data-retro-dropdown]');dropdowns.forEach(function(dropdown){if(RetroUI.config.closeOnOutsideClick){document.addEventListener('click',function(e){if(dropdown.open && !dropdown.contains(e.target)){dropdown.open=false;}});}if(RetroUI.config.closeOnEscape){dropdown.addEventListener('keydown',function(e){if(e.key==='Escape' && dropdown.open){dropdown.open=false;dropdown.querySelector('summary').focus();}});}dropdown.addEventListener('keydown',function(e){if(!dropdown.open)return;const items=dropdown.querySelectorAll('.retro-dropdown-item');const currentIndex=Array.from(items).findIndex(item=> item===document.activeElement);switch(e.key){case 'ArrowDown': e.preventDefault();const nextIndex=currentIndex < items.length-1 ? currentIndex+1 : 0;items[nextIndex].focus();break;case 'ArrowUp': e.preventDefault();const prevIndex=currentIndex > 0 ? currentIndex-1 : items.length-1;items[prevIndex].focus();break;}});const summary=dropdown.querySelector('summary');const content=dropdown.querySelector('.retro-dropdown-content');if(summary && content){summary.setAttribute('aria-haspopup','true');summary.setAttribute('aria-expanded',dropdown.open ? 'true' : 'false');content.setAttribute('role','menu');dropdown.addEventListener('toggle',function(){summary.setAttribute('aria-expanded',dropdown.open ? 'true' : 'false');});}});}},Accordion:{init: function(){const accordions=document.querySelectorAll('details[data-retro-accordion]');accordions.forEach(function(accordion){accordion.addEventListener('toggle',function(){const content=accordion.querySelector('.retro-accordion-content');if(content){if(accordion.open){content.style.animation='retro-accordion-expand 0.3s ease';}}});accordion.addEventListener('keydown',function(e){const summary=accordion.querySelector('summary');if(e.target===summary &&(e.key==='Enter' || e.key===' ')){e.preventDefault();accordion.open=!accordion.open;}});const summary=accordion.querySelector('summary');const content=accordion.querySelector('.retro-accordion-content');if(summary && content){summary.setAttribute('aria-expanded',accordion.open ? 'true' : 'false');content.setAttribute('role','region');accordion.addEventListener('toggle',function(){summary.setAttribute('aria-expanded',accordion.open ? 'true' : 'false');});}});}},Modal:{init: function(){const modals=document.querySelectorAll('.retro-modal');modals.forEach(function(modal){if(RetroUI.config.closeOnOutsideClick){modal.addEventListener('click',function(e){if(e.target===modal){RetroUI.Modal.close(modal);}});}if(RetroUI.config.closeOnEscape){modal.addEventListener('keydown',function(e){if(e.key==='Escape'){RetroUI.Modal.close(modal);}});}const closeButton=modal.querySelector('.retro-modal-close');if(closeButton){closeButton.addEventListener('click',function(e){e.preventDefault();RetroUI.Modal.close(modal);});}modal.addEventListener('transitionend',function(){if(modal.matches(':target')){RetroUI.utils.trapFocus(modal);}});});},open: function(modalId){const modal=document.getElementById(modalId);if(modal){window.location.hash=modalId;document.body.style.overflow='hidden';RetroUI.utils.log(`Modal opened: ${modalId}`);}},close: function(modal){if(typeof modal==='string'){modal=document.getElementById(modal);}if(modal){window.location.hash='';document.body.style.overflow='';RetroUI.utils.log('Modal closed');}}},Theme:{setColors: function(colors){const root=document.documentElement;Object.keys(colors).forEach(function(key){root.style.setProperty(`--retro-${key}`,colors[key]);});RetroUI.utils.log('Theme colors updated');},reset: function(){const root=document.documentElement;const customProperties=[ '--retro-primary-bg','--retro-primary-text','--retro-primary-shadow','--retro-secondary-bg','--retro-secondary-text','--retro-secondary-shadow','--retro-button-bg','--retro-button-text','--retro-button-shadow','--retro-card-bg','--retro-card-text','--retro-card-shadow','--retro-input-bg','--retro-input-text' ];customProperties.forEach(function(property){root.style.removeProperty(property);});RetroUI.utils.log('Theme reset to default');}},init: function(options={}){Object.assign(RetroUI.config,options);RetroUI.Dropdown.init();RetroUI.Accordion.init();RetroUI.Modal.init();document.addEventListener('keydown',function(e){if(e.key==='Escape'){const openDropdowns=document.querySelectorAll('.retro-dropdown[open],details[data-retro-dropdown][open]');openDropdowns.forEach(function(dropdown){dropdown.open=false;});}});RetroUI.utils.log('RetroUI initialized');}};if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',RetroUI.init);}else{RetroUI.init();}window.RetroUI=RetroUI;})(window,document);